name: weekly-check
description: Weekly progress check and schedule alignment verification
language: ja
tone: professional

system_prompt: |
  あなたは週次進捗管理を行うAIアシスタントです。
  提供されたGitHubとSlackのデータを分析して、週次の進捗確認レポートを作成してください。

  重点的にチェックする項目：
  1. **今週の完了タスク** - 予定通り完了したもの
  2. **進行中のタスク** - 現在作業中のもの
  3. **遅延タスク** - スケジュールから遅れているもの
  4. **未着手タスク** - 今週やる予定だったが手をつけていないもの
  5. **Slack活動分析** - ミーティングでの宣言と実際の進捗の整合性

  分析のポイント：
  - PRとIssueのタイトル・説明から進捗状況を推測
  - Slackのメッセージから「今週やる」「来週までに」などのコミットメントを抽出
  - コミットメントと実際の作業（PR/Issue）の対応関係をチェック
  - 遅延の兆候（「まだできてない」「時間かかってる」など）を検出

slack_output_format: |
  *週次進捗チェック - {week_description}*

  *📊 サマリー*
  • 対象期間: {start_date} - {end_date}
  • 完了PR: {completed_pr_count}件
  • クローズIssue: {closed_issue_count}件
  • Slack活動: {message_count}メッセージ, {thread_count}スレッド

  ---

  *✅ 今週完了したタスク*

  {completed_tasks_list}

  > *評価*: {completion_assessment}

  ---

  *🚧 進行中のタスク*

  {ongoing_tasks_list}

  > *注意点*: {ongoing_notes}

  ---

  *⚠️ 遅延・課題*

  {delayed_tasks_section}

  🎯 *対応必要*: {action_items}

  ---

  *📝 コミットメントチェック*

  Slackでの発言とGitHub上の実績を照らし合わせました：

  {commitment_check_list}

  ---

  *💬 Slack活動ハイライト*

  {slack_highlights}

  ---

  *🎯 来週への引き継ぎ事項*

  {handover_items}

  ---

  > *総評*: {overall_assessment}

  **フォーマット要件:**
  - セクション見出しは絵文字 + 太字 (*テキスト*)
  - タスク: • タスク名 (<https://github.com/{owner}/{repo}/pull/{number}|#{number}>)
  - 評価コメント: 引用ブロック (> 評価内容)
  - 重要な注意: ⚠️ *注意:* 内容
  - アクションアイテム: 🎯 *TODO:* 内容
  - 良好: ✅, 🎉 / 注意: ⚠️, 🚧 / 問題: 🔴, ❌

notion_title_format: "📅 週次進捗チェック - {period}"

notion_output_format: |
  # 📅 週次進捗チェック

  **期間:** {start_date} - {end_date}

  > 📊 **サマリー**
  > - **完了PR:** {completed_pr_count}件
  > - **クローズIssue:** {closed_issue_count}件
  > - **Slack活動:** {message_count}メッセージ, {thread_count}スレッド

  ---

  ## ✅ 今週完了したタスク

  {completed_tasks_list}

  > ✅ **評価**
  > {completion_assessment}

  ---

  ## 🚧 進行中のタスク

  {ongoing_tasks_list}

  > 💡 **注意点**
  > {ongoing_notes}

  ---

  ## ⚠️ 遅延・課題

  {delayed_tasks_section}

  > ⚠️ **対応必要**
  > {action_items}

  ---

  ## 📝 コミットメントチェック

  Slackでの発言とGitHub上の実績を照らし合わせました：

  {commitment_check_list}

  ---

  ## 💬 Slack活動ハイライト

  {slack_highlights}

  ---

  ## 🎯 来週への引き継ぎ事項

  {handover_items}

  ---

  > 🎯 **総評**
  > {overall_assessment}

  **フォーマット要件:**
  - heading_1 (#) でタイトル
  - heading_2 (##) で各セクション
  - callout (>) でサマリー、評価、総評
  - bulleted_list_item (-) でタスクリスト
  - numbered_list_item (1.) でアクションアイテム
  - divider (---) でセクション区切り
  - PRリンク: [#{number}](https://github.com/{owner}/{repo}/pull/{number})

categories:
  - name: "完了タスク"
    keywords: ["完了", "done", "finished", "merged", "closed", "fix", "resolve"]
    description: "今週中に完了したタスク"
    priority: high

  - name: "進行中タスク"
    keywords: ["wip", "draft", "進行中", "作業中", "実装中"]
    description: "現在進行中のタスク"
    priority: high

  - name: "遅延タスク"
    keywords: ["遅延", "delay", "遅れ", "間に合わない", "延期"]
    description: "スケジュールから遅れているタスク"
    priority: critical

  - name: "レビュー待ち"
    keywords: ["review", "レビュー", "確認待ち"]
    description: "レビュー待ちのPR"
    priority: medium

  - name: "ブロッカー"
    keywords: ["blocked", "block", "ブロック", "依存", "待ち"]
    description: "進行をブロックしている課題"
    priority: critical

analysis_guidelines:
  commitment_extraction:
    patterns:
      - "今週.*やる"
      - "今週中に"
      - "週内に"
      - ".*までに完了"
      - "今日中"
      - "明日まで"
    context_window: 3  # メッセージ前後3件も確認

  delay_detection:
    patterns:
      - "遅れ"
      - "間に合わない"
      - "延期"
      - "まだできてない"
      - "時間かかってる"
      - "厳しい"
    severity_keywords:
      high: ["クリティカル", "緊急", "至急"]
      medium: ["できれば", "可能なら"]

  progress_indicators:
    positive:
      - "完了"
      - "終わった"
      - "マージした"
      - "リリースした"
    negative:
      - "まだ"
      - "途中"
      - "進んでない"
